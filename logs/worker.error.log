objc[2906]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[2906]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[3145]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[3145]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[3147]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[3147]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[3151]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[3151]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[3162]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[3162]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Exception in thread Thread-1Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
16:33:17 Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
19:07:09 Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
objc[8352]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[8352]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Exception in thread Exception in thread Thread-1Thread-1:
:
Thread-1:
Traceback (most recent call last):
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()        
self.run()self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,pubsub.get_message(ignore_subscribe_messages=True,
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message

pubsub.get_message(ignore_subscribe_messages=True,  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)response = self.parse_response(block=False, timeout=timeout)

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
return self._buffer and self._buffer.can_read(timeout)    
return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    redis.exceptionsself._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    .raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
ConnectionError: Connection closed by server.
redis.exceptions.ConnectionError: Connection closed by server.
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 198, in _read_from_socket
Traceback (most recent call last):
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 198, in _read_from_socket
data = recv(self._sock, socket_read_size)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/_compat.py", line 72, in recv
    data = recv(self._sock, socket_read_size)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/_compat.py", line 72, in recv
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    return sock.recv(*args, **kwargs)
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4019, in execute
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    return execute(conn, stack, raise_on_error)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3894, in _execute_transaction
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
        raise ConnectionError(self._error_message(e))self.parse_response(connection, '_')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3977, in parse_response
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    result = Redis.parse_response(
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 915, in parse_response

redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    response = connection.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 739, in read_response
    return sock.recv(*args, **kwargs)
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
        return _run_code(code, main_globals, None,response = self._parser.read_response()

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 324, in read_response
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    raw = self._buffer.readline()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 256, in readline
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    self._read_from_socket()    
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 222, in _read_from_socket
click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    raise ConnectionError("Error while reading from socket: %s" %
redis.exceptions.ConnectionError: Error while reading from socket: (54, 'Connection reset by peer')
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4019, in execute
    return execute(conn, stack, raise_on_error)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3894, in _execute_transaction
    self.parse_response(connection, '_')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3977, in parse_response
    result = Redis.parse_response(
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 915, in parse_response
    response = connection.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 739, in read_response
    response = self._parser.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 324, in read_response
    raw = self._buffer.readline()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 256, in readline
    self._read_from_socket()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 222, in _read_from_socket
    raise ConnectionError("Error while reading from socket: %s" %
redis.exceptions.ConnectionError: Error while reading from socket: (54, 'Connection reset by peer')
Exception in thread Exception in thread Thread-1:
Exception in thread Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[1279]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1279]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1293]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1293]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1300]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1300]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1301]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1301]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1336]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1336]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[9848]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[9848]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[9885]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[9885]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Thread-1Exception in thread :
Thread-1:
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
        return self._parser.can_read(timeout)
return self._parser.can_read(timeout)  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
return self._buffer and self._buffer.can_read(timeout)  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    redis.exceptionsraise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR).
ConnectionErrorredis.exceptions: .Connection closed by server.ConnectionError
: redis.exceptionsConnection closed by server..
ConnectionError: Connection closed by server.
13:45:53 Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
13:47:20 Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 1008, in perform_job
    rv = job.perform()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 706, in perform
    self._result = self._execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/job.py", line 729, in _execute
    result = self.func(*self.args, **self.kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 100, in execute_job
    method(**kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 461, in sendmail
    communication._notify(print_html=print_html, print_format=print_format, attachments=attachments,
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/communication.py", line 211, in _notify
    _notify(self, print_html, print_format, attachments, recipients, cc, bcc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 151, in _notify
    prepare_to_notify(doc, print_html, print_format, attachments)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 233, in prepare_to_notify
    set_incoming_outgoing_accounts(doc)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/core/doctype/communication/email.py", line 293, in set_incoming_outgoing_accounts
    doc.db_set("email_account", doc.outgoing_email_account.name)
AttributeError: 'NoneType' object has no attribute 'name'
Exception in thread Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[1521]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1521]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1565]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1565]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[6408]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[6408]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[6437]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[6437]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Exception in thread Thread-1:
Thread-1:
Exception in thread Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()        
self.run()self.run()  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run


  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,    
pubsub.get_message(ignore_subscribe_messages=True,
pubsub.get_message(ignore_subscribe_messages=True,  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
        response = self.parse_response(block=False, timeout=timeout)
response = self.parse_response(block=False, timeout=timeout)  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)    
return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
        self._read_from_socket(timeout=timeout,redis.exceptions
self._read_from_socket(timeout=timeout,.  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
ConnectionError
: Connection closed by server.
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.redis.exceptions.ConnectionErrorConnectionError: Connection closed by server.
: Connection closed by server.
Exception in thread Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[7727]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[7727]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Exception in thread Thread-1:
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
        return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Exception in thread Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)    self._read_from_socket(timeout=timeout,

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    return self._parser.can_read(timeout)redis.exceptions.ConnectionError: Connection closed by server.

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Exception in thread Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[1618]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1618]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1646]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1646]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Traceback (most recent call last):
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
redis.exceptions.ConnectionError: Connection closed by server.
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    sock.connect(socket_address)

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return callback(*args, **kwargs)
      File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    rv = self.invoke(ctx)    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    conn = self.connection_pool.get_connection('MULTI',
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)    
return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
    self._read_from_socket(timeout=timeout,  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
redis.exceptions.ConnectionError: Connection closed by server.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 198, in _read_from_socket
    data = recv(self._sock, socket_read_size)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/_compat.py", line 72, in recv
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 198, in _read_from_socket
    data = recv(self._sock, socket_read_size)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/_compat.py", line 72, in recv
    return sock.recv(*args, **kwargs)    return sock.recv(*args, **kwargs)
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message

    if not block and not conn.can_read(timeout=timeout):
ConnectionResetError: [Errno 54] Connection reset by peer
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
      File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
        response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)        
return _run_code(code, main_globals, None,
Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
response = self.parse_response(block=False, timeout=timeout)redis.exceptions

.  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
ConnectionError  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
:     Connection closed by server.
exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
        main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    start_worker(queue, quiet = quiet)
if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
        return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4019, in execute
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4019, in execute
        connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
return execute(conn, stack, raise_on_error)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3894, in _execute_transaction
    return execute(conn, stack, raise_on_error)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3894, in _execute_transaction
    self.parse_response(connection, '_')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3977, in parse_response
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
    self.parse_response(connection, '_')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3977, in parse_response
    result = Redis.parse_response(
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 915, in parse_response
    response = connection.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 739, in read_response
    response = self._parser.read_response()
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 324, in read_response
result = Redis.parse_response(
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 915, in parse_response
    raw = self._buffer.readline()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 256, in readline
    self._read_from_socket()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 222, in _read_from_socket
    response = connection.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 739, in read_response
    raise ConnectionError("Error while reading from socket: %s" %
redis.exceptions.ConnectionError: Error while reading from socket: (54, 'Connection reset by peer')
    response = self._parser.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 324, in read_response
    raw = self._buffer.readline()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 256, in readline
    self._read_from_socket()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 222, in _read_from_socket
    raise ConnectionError("Error while reading from socket: %s" %
redis.exceptions.ConnectionError: Error while reading from socket: (54, 'Connection reset by peer')
Exception in thread Exception in thread Thread-1Thread-1:
:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    if not block and not conn.can_read(timeout=timeout):    
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Exception in thread Exception in thread Thread-1Exception in thread :
Thread-1Thread-1Traceback (most recent call last):
:
:
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
self.run()  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Exception in thread Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
        self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    sock.connect(socket_address)
ConnectionRefusedError:     return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
[Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
Traceback (most recent call last):
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Exception in thread Exception in thread Thread-1Exception in thread :
Thread-1Thread-1:
Traceback (most recent call last):
Traceback (most recent call last):
:
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()    self.run()
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
        pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    redis.exceptions.ConnectionError: Connection closed by server.
self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 559, in connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    sock = self._connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 615, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    raise err
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 603, in _connect
    sock.connect(socket_address)
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    sock.connect(socket_address)
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
ConnectionRefusedError: [Errno 61] Connection refused

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4012, in execute
    conn = self.connection_pool.get_connection('MULTI',
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 1192, in get_connection
    connection.connect()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 563, in connect
    raise ConnectionError(self._error_message(e))
redis.exceptions.ConnectionError: Error 61 connecting to localhost:11000. Connection refused.
Exception in thread Exception in thread Exception in thread Thread-1Thread-1:
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
pubsub.get_message(ignore_subscribe_messages=True,    return self._parser.can_read(timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read

return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    redis.exceptionsraise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
.ConnectionError: Connection closed by server.

redis.exceptions.ConnectionError: Connection closed by server.
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Thread-1:
Exception in thread Thread-1:
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
            return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)        return self._buffer and self._buffer.can_read(timeout)
self._read_from_socket(timeout=timeout,

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    self._read_from_socket(timeout=timeout,
redis.exceptions  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
.raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
ConnectionError: Connection closed by server.
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Exception in thread Exception in thread Thread-1:
Thread-1:
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
ConnectionError: Connection closed by server.
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Exception in thread Exception in thread Thread-1Thread-1:
:
Traceback (most recent call last):
Thread-1  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
        response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[1003]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1003]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1018]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1018]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1026]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1026]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1028]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1028]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1298]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1298]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[2641]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[2641]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
Exception in thread Thread-1  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
        return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Exception in thread Exception in thread Thread-1Thread-1:
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,self._read_from_socket(timeout=timeout,    

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
return self._parser.can_read(timeout)  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
redis.exceptions.ConnectionError: Connection closed by server.
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[1220]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1220]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[11026]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[11026]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Exception in thread Exception in thread Exception in thread Thread-1Thread-1:
Thread-1Thread-1Traceback (most recent call last):
:
:
:
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()    
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        self.run()self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
    return self._buffer and self._buffer.can_read(timeout)  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    redis.exceptions.ConnectionError: Connection closed by server.
self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[1518]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1518]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1527]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1527]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1531]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1531]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1537]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1537]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1741]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1741]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1743]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1743]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1905]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1905]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Exception in thread Thread-1:
Exception in thread Thread-1:
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
      File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Exception in thread Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1Thread-1:
:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
        self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[953]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[953]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[979]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[979]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
        self.run()
self.run()  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run

    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
        return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
    self._read_from_socket(timeout=timeout,redis.exceptions
.  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
ConnectionErrorraise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR): Connection closed by server.
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)

redis.exceptionsredis.exceptions.ConnectionError.: ConnectionErrorConnection closed by server.: 
Connection closed by server.
objc[4164]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[4164]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[4201]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[4201]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 198, in _read_from_socket
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    data = recv(self._sock, socket_read_size)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/_compat.py", line 72, in recv
    return sock.recv(*args, **kwargs)
ConnectionResetError: [Errno 54] Connection reset by peer

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 101, in <module>
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    main()
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/bench_helper.py", line 18, in main
    click.Group(commands=commands)(prog_name='bench')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 829, in __call__
    return self.main(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 782, in main
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    rv = self.invoke(ctx)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1259, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 1066, in invoke
    return ctx.invoke(self.callback, **ctx.params)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/click/core.py", line 610, in invoke
    return callback(*args, **kwargs)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/commands/scheduler.py", line 178, in start_worker
    start_worker(queue, quiet = quiet)
  File "/Users/andela/Dev/frappe-bench/apps/frappe/frappe/utils/background_jobs.py", line 151, in start_worker
    Worker(queues, name=get_worker_name(queue)).work(logging_level = logging_level)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 621, in work
    self.register_death()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/rq/worker.py", line 326, in register_death
    p.execute()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 4019, in execute
    return execute(conn, stack, raise_on_error)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3894, in _execute_transaction
    self.parse_response(connection, '_')
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3977, in parse_response
    result = Redis.parse_response(
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 915, in parse_response
    response = connection.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 739, in read_response
    response = self._parser.read_response()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 324, in read_response
    raw = self._buffer.readline()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 256, in readline
    self._read_from_socket()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 222, in _read_from_socket
    raise ConnectionError("Error while reading from socket: %s" %
redis.exceptions.ConnectionError: Error while reading from socket: (54, 'Connection reset by peer')
Exception in thread Exception in thread Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
        response = self.parse_response(block=False, timeout=timeout)return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[2666]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[2666]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
Exception in thread Exception in thread Thread-1:
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[1560]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1560]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1609]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1609]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[1640]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[1640]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[17113]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[17113]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[17160]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[17160]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[17191]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[17191]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
Exception in thread Exception in thread Thread-1:
Thread-1:
Traceback (most recent call last):
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
Exception in thread Thread-1:
Traceback (most recent call last):
  File "/usr/local/Cellar/python@3.9/3.9.4/Frameworks/Python.framework/Versions/3.9/lib/python3.9/threading.py", line 954, in _bootstrap_inner
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
    self.run()
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3718, in run
        pubsub.get_message(ignore_subscribe_messages=True,
    pubsub.get_message(ignore_subscribe_messages=True,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
pubsub.get_message(ignore_subscribe_messages=True,  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message

  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3617, in get_message
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    response = self.parse_response(block=False, timeout=timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/client.py", line 3503, in parse_response
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    if not block and not conn.can_read(timeout=timeout):
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 734, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    return self._parser.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 321, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
    return self._buffer and self._buffer.can_read(timeout)
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 230, in can_read
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    self._read_from_socket(timeout=timeout,
  File "/Users/andela/Dev/frappe-bench/env/lib/python3.9/site-packages/redis/connection.py", line 201, in _read_from_socket
    raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.    
raise ConnectionError(SERVER_CLOSED_CONNECTION_ERROR)
redis.exceptions.ConnectionError: Connection closed by server.
objc[5340]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[5340]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[5368]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[5368]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
objc[5398]: +[NSValue initialize] may have been in progress in another thread when fork() was called.
objc[5398]: +[NSValue initialize] may have been in progress in another thread when fork() was called. We cannot safely call it or ignore it in the fork() child process. Crashing instead. Set a breakpoint on objc_initializeAfterForkError to debug.
